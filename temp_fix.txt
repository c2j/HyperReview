        Err(last_error.unwrap_or_else(|| {
            GerritClientError::ConnectionError("All retry attempts failed".to_string())
        }))