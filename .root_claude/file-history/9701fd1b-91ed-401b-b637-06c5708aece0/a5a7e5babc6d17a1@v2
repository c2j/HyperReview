//! Enum types for HyperReview domain models
//!
//! Following Constitution III requirements for strong typing.

use serde::{Deserialize, Serialize};

/// Git provider type
#[derive(Debug, Clone, Copy, PartialEq, Eq, Hash, Serialize, Deserialize)]
pub enum Provider {
    GitHub,
    GitLab,
}

impl Provider {
    /// Get provider name as string
    pub fn as_str(&self) -> &'static str {
        match self {
            Provider::GitHub => "github",
            Provider::GitLab => "gitlab",
        }
    }
}

/// Pull request status
#[derive(Debug, Clone, Copy, PartialEq, Eq, Serialize, Deserialize)]
pub enum PrStatus {
    Open,
    Closed,
    Merged,
}

impl PrStatus {
    /// Parse from GitHub API state string
    pub fn from_github(state: &str, merged: bool) -> Self {
        if merged {
            PrStatus::Merged
        } else if state == "closed" {
            PrStatus::Closed
        } else {
            PrStatus::Open
        }
    }
}

/// CI/Build status
#[derive(Debug, Clone, Copy, PartialEq, Eq, Serialize, Deserialize)]
pub enum CiStatus {
    Pending,
    Success,
    Failure,
}

impl CiStatus {
    /// Parse from GitHub API state string
    pub fn from_github(state: &str) -> Self {
        match state {
            "success" => CiStatus::Success,
            "failure" | "error" => CiStatus::Failure,
            _ => CiStatus::Pending,
        }
    }
}

/// Sync status for offline-first entities
#[derive(Debug, Clone, Copy, PartialEq, Eq, Serialize, Deserialize)]
pub enum SyncStatus {
    /// Created locally, not yet synced
    Pending,
    /// Successfully synced to provider
    Synced,
    /// Sync failed, manual intervention needed
    Failed,
}

/// Review decision type
#[derive(Debug, Clone, Copy, PartialEq, Eq, Serialize, Deserialize)]
pub enum ReviewDecision {
    Approve,
    RequestChanges,
    Comment,
}

impl ReviewDecision {
    /// Convert to GitHub API event string
    pub fn to_github_event(&self) -> &'static str {
        match self {
            ReviewDecision::Approve => "APPROVE",
            ReviewDecision::RequestChanges => "REQUEST_CHANGES",
            ReviewDecision::Comment => "COMMENT",
        }
    }
}

/// File status in diff
#[derive(Debug, Clone, Copy, PartialEq, Eq, Serialize, Deserialize)]
pub enum FileStatus {
    Added,
    Modified,
    Deleted,
    Renamed,
}

/// Line type in diff
#[derive(Debug, Clone, Copy, PartialEq, Eq, Serialize, Deserialize)]
pub enum LineType {
    /// Unchanged context line
    Context,
    /// Added line
    Addition,
    /// Deleted line
    Deletion,
}
