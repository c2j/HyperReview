# HyperReview 官方 UI 文档（v3.1 Final · 2025 版）  
—— 专为 Java / SpringBoot + SQL 重度 Tech Lead 打造的「零延迟人工代码审查神器」

## 1. 设计理念（三句话（钉在所有开发者头顶）

1. 每一像素都必须为顶级 reviewer 的肌肉记忆服务  
2. 永远不超过一次鼠标点击或两次键盘敲击就能完成任何高频操作  
3. 让人类在最后 20% 的高价值审查中碾压所有 AI

## 2. 全局布局与宽度比例（已永久锁死）

```
┌────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ 标题栏 + 搜索栏                                                                                  │
├────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ 工具栏 + 当前仓库信息横栏（无缝衔接，无一像素浪费）                                               │
├──────────────┬───────────────────────────────┬───────────────────────────────────────────────────┤
│              │                               │                                                   │
│   15%        │             55%               │                     30%                            │
│ 左侧任务区   │       中央 Diff 主战场        │                 右侧四面板                        │
│              │                               │                                                   │
├──────────────┴───────────────────────────────┴───────────────────────────────────────────────────┤
│ 全局魔术操作条（永不消失，键盘信仰）                                                             │
└────────────────────────────────────────────────────────────────────────────────────────────────────┘
│ 状态栏（信息密度拉满）                                                                           │
└────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

## 3. 各区域像素级详述

### 3.1 标题栏 + 搜索栏（高度 46px）

```
HyperReview v3.1 ──────────────────────── Tech Lead 模式 ──────────────────────────── 23:59 ●
⌕  全局搜索（ripgrep <10ms）                     ⊛  语义搜索 "订单超时补偿"         🔄 同步中   ⚙
```

- 快捷键：Ctrl+F → 普通搜索，Ctrl+Shift+F → 语义搜索

### 3.2 工具栏 + 当前仓库信息横栏（高度 52px，零空白）

```
+打开仓库   +导入任务   提交到 ▾ CodeArts / Gerrit / GitLab / 自建   模式 ▾ Java+SQL / SQL / 通用
快捷标签 ▾ [✗严重-N+1] [✗严重-事务缺失] [⚠关注-硬编码] [模板管理…]

当前仓库：/home/lead/payment-service     feature/payment-retry (3c9fa1b ▼12↑3)     127 文件待审
```

### 3.3 左侧任务区（固定 15%，最小 280px）

```
▼ 待我审核 (47)
  ○ PR#2877 支付超时补偿重构
  ● PR#2871 用户中心权限翻新         ← 红点 = 有新回复
  ○ PR#2869 Oracle 存储过程优化
  ○ 本地任务#11 SQL 审查清单

▼ 我关注的 (12)
  ● PR#2847 @me 异步任务重构 (3未读)

▼ 历史审查 (今日完成 127)
  LGTM   PR#2831 订单状态机
  Blocked PR#2829 缺少事务边界

+ 创建本地审查任务（支持拖入文件夹、PR链接、Gerrit Change-ID）
```

快捷键：j/k 上下，Enter 进入，d 删除，r 刷新

### 3.4 中央 Diff 主战场（55%，核心核武器）

```
文件: src/main/java/com/alipay/payment/service/impl/RetryServiceImpl.java   +342 −108   [折叠导入] [折叠Lombok]
模式: Java+SpringBoot

旧版          变更热力条               新版（主战场）
(灰底)       ████████ 78% 重构
101          ████ 40% 修改         124  public void retry(...) {
102                                +125      log.info("开始重试...");
103          ████████████ 100%     +126      orderMapper.selectById(orderId);
104                                +127      orderMapper.updateStatus(...);   ← 橙色波浪线：N+1 风险
124                                128      // 缺少 @Transactional          ← 红色警示框
125                                129  }
```

- 选中后右键菜单（无模态浮层）：
- ✗ 必须改  
- ⚠ 需要关注  
- ❓ 提问作者  
- ✓ 通过此 hunk  
- 插入模板 → 事务边界缺失 / 潜在N+1 / 硬编码SQL 等  
- 生成修复补丁

### 3.5 右侧四面板（30%，Alt+1~4 切换）

**Tab 1 – 架构影响热图**（默认）
```
payment-service 模块依赖图
████ payment   ████ auth   ████ db   ██░░ cache   ████ api
红色越深 = 被本次审查改动波及越大，点击模块 → 自动跳转文件
```

**Tab 2 – 瞬时 Blame**
```
✪ alice@2025-11-20 18:33
PR#2711 “引入重试状态机”
当时审查人：ferris (LGTM with nit)
当时评论：这里容易死锁，已加锁优化
```

**Tab 3 – 审查统计看板**
```
已审查 73 / 127 文件
✗ 严重问题      12
⚠ 需要关注      28
❓ 待回复         7
预计剩余时间    11 分钟
```

**Tab 4 – 待审清单（支持拖拽排序）**
```
src/main/java/com/alipay/**/*.java
src/main/resources/mapper/*Payment*.xml
db/procedure/pkg_payment.pkb   L200-500
[全选] [反选] [移除]
```

### 3.6 全局魔术操作条（高度 42px，半透明永驻）

```
[✓]整文件通过  [⚠]标记关注  [✗]必须改  [❓]提问  c写评论  gd跳定义  gb blame  gr引用行
Ctrl+Enter 下一文件   Shift+Enter 整批审完并推送   Alt+1~4 切右侧面板   Esc 退出评论
```

### 3.7 状态栏（最底部一行，信息密度拉满）

```
[/payment-service/feature/payment-retry] 127文件 → 已圈选47处 (✗12 ⚠28 ❓7)  就绪 → 推送至 CodeArts (OpenAPI)  23:59
```

## 4. 配色规范（暗色盲友好，已实测）

| 用途               | 颜色代码      | 说明                     |
|--------------------|---------------|--------------------------|
| 背景主色           | #1e1e1e      | VSCode Dark+ 同款        |
| 选中行             | #264f78      |                          |
| 变更热力条 - 删除  | #f14c4c      |                          |
| 变更热力条 - 添加  | #5cc46b      |                          |
| 变更热力条 - 重构  | #e2c08d      |                          |
| 严重问题标签        | ✗ #f14c4c   ⚠ #ff8800   ❓ #409eff   ✓ #5cc46b |

## 5. 字体与字号（已做 4K 适配）

- 界面文字：JetBrains Mono / Sarasa Gothic SC  13px
- 代码区：JetBrains Mono 14px（支持 12-24px 自由缩放）
- 行距 1.6，字距 +0.5px
